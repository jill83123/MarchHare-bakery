import{s as x}from"./statesStore-1222e2d4.js";import{C,a as T}from"./ckeditor-0b614489.js";import{m as $}from"./modalMixin-a9be93c2.js";import{c as M,r as _,o as n,d as l,e,t as f,g as u,h as v,F as w,i as k,l as h,v as m,f as b,y as I,n as g,S as L}from"./index-bf4ebe37.js";import{D,P as V}from"./PaginationBackend-4f3459f0.js";import"./tw-elements.es.min-69e8dc80.js";const z={data(){return{tempProduct:{},tempTag:"",loadingIcon:!1,editor:C,editorConfig:{toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","|","imageUpload","blockQuote","undo","redo"]}}},props:{product:{type:Object,default(){return{tempProduct:{}}}},state:{type:String,default:""},allTags:{type:Array,default(){return[]}}},watch:{product(){this.tempProduct=this.product}},methods:{uploadPhoto(r){if(r==="button"&&this.$refs.imageUrlInput.value!==""){if(this.loadingIcon=!0,this.tempProduct.imageUrl===""||!this.tempProduct.imageUrl){this.tempProduct.imageUrl=this.$refs.imageUrlInput.value,this.$refs.imageUrlInput.value="",this.loadingIcon=!1;return}this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imagesUrl.push(this.$refs.imageUrlInput.value),this.$refs.imageUrlInput.value="",this.loadingIcon=!1}if(r==="file"){this.loadingIcon=!0;const o=this.$refs.imageFileInput.files[0],a=new FormData;a.append("file-to-upload",o);const d="https://vue3-course-api.hexschool.io/api/yu-api/admin/upload";this.$http.post(d,a).then(t=>{if(t.data.success){if(this.tempProduct.imageUrl===""||!this.tempProduct.imageUrl){this.tempProduct.imageUrl=t.data.imageUrl,this.$refs.imageFileInput.value="",this.loadingIcon=!1,x().pushToastMessage(t.data.success,"上傳成功");return}this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imagesUrl.push(t.data.imageUrl),this.$refs.imageFileInput.value="",this.loadingIcon=!1,x().pushToastMessage(t.data.success,"上傳成功")}else x().pushToastMessage(t.data.success,"上傳失敗",t.data.message)})}},delPhoto(r){this.tempProduct.imageUrl===r?this.tempProduct.imageUrl="":this.tempProduct.imagesUrl.splice(r,1)},pushTag(){this.tempProduct.tag||(this.tempProduct.tag=[]),this.tempProduct.tag.push(this.tempTag),this.tempTag=""},selectTag(r){this.tempProduct.tag||(this.tempProduct.tag=[]);const o=this.tempProduct.tag.indexOf(r);o<0?this.tempProduct.tag.push(r):this.tempProduct.tag.splice(o,1)}},mixins:[$],components:{ckeditor:T.component}},S={"data-te-modal-init":"",class:"fixed left-0 top-0 z-[1055] hidden h-full w-full overflow-y-auto overflow-x-hidden outline-none",id:"addModal",tabindex:"-1","aria-labelledby":"productModal","aria-modal":"true",role:"dialog","data-te-backdrop":"static",ref:"modal"},j={"data-te-modal-dialog-ref":"",class:"pointer-events-none relative mt-7 w-auto translate-y-[-50px] px-2 opacity-0 transition-all duration-300 ease-in-out min-[576px]:mx-auto min-[576px]:max-w-[800px] sm:px-5 min-[1024px]:max-w-[1140px]"},F={class:"pointer-events-auto relative flex max-h-[94vh] w-full flex-col rounded-md border-none bg-white bg-clip-padding text-current shadow-lg outline-none lg:max-h-[90vh]"},E={class:"flex flex-shrink-0 items-center justify-between rounded-t-md border-b-2 border-neutral-100 border-opacity-100 p-4"},B={class:"text-xl font-medium leading-normal text-neutral-800",id:"exampleModalXlLabel"},A=e("button",{type:"button",class:"box-content rounded-none border-none hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none","data-te-modal-dismiss":"","aria-label":"Close"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-6 w-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1),O={class:"relative overflow-y-auto p-4"},N={class:"flex flex-col-reverse gap-5 lg:flex-row"},R={class:"border-t-2 lg:w-5/12 lg:border-0"},Z={class:"mb-4 mt-4 lg:mt-0"},q={for:"formFile",class:"mb-1 flex gap-2 text-neutral-700"},K={key:0,class:"flex items-center gap-2 text-gray-500"},G=e("div",{class:"inline-block h-4 w-4 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",role:"status"},[e("span",{class:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]"}," Loading... ")],-1),Q=e("p",null,"上傳中",-1),X=[G,Q],H=["disabled"],J={class:"mb-4"},W=e("label",{for:"imageUrl",class:"mb-1 block"},"或 輸入網址",-1),Y={class:"relative flex flex-wrap items-stretch"},ee=["disabled"],te={class:"relative aspect-square w-full p-1"},oe=e("div",{class:"absolute bottom-[1%] left-[1%] right-[1%] top-[1%] flex items-center justify-center border-2 border-dotted"},[e("div",{class:"text-center text-gray-400"},[e("h6",{class:"text-2xl leading-10"},"主要圖片"),e("p",null,"假如目前沒有主要圖片，上傳時會優先補上")])],-1),se={key:0,class:"relative bg-white"},re=["src","alt","title"],ne=e("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M3.4 16L2 14.6L7.6 9L2 3.4L3.4 2L9 7.6L14.6 2L16 3.4L10.4 9L16 14.6L14.6 16L9 10.4L3.4 16Z",fill:"white","fill-opacity":"0.8"}),e("path",{d:"M3.04645 16.3536L3.4 16.7071L3.75355 16.3536L9 11.1071L14.2464 16.3536L14.6 16.7071L14.9536 16.3536L16.3536 14.9536L16.7071 14.6L16.3536 14.2464L11.1071 9L16.3536 3.75355L16.7071 3.4L16.3536 3.04645L14.9536 1.64645L14.6 1.29289L14.2464 1.64645L9 6.89289L3.75355 1.64645L3.4 1.29289L3.04645 1.64645L1.64645 3.04645L1.29289 3.4L1.64645 3.75355L6.89289 9L1.64645 14.2464L1.29289 14.6L1.64645 14.9536L3.04645 16.3536Z",stroke:"#303030","stroke-opacity":"0.8","stroke-miterlimit":"10"})],-1),le=[ne],ae={class:"flex flex-wrap"},ie=["src","alt"],ce=["title","onClick"],de=e("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M3.4 16L2 14.6L7.6 9L2 3.4L3.4 2L9 7.6L14.6 2L16 3.4L10.4 9L16 14.6L14.6 16L9 10.4L3.4 16Z",fill:"white","fill-opacity":"0.8"}),e("path",{d:"M3.04645 16.3536L3.4 16.7071L3.75355 16.3536L9 11.1071L14.2464 16.3536L14.6 16.7071L14.9536 16.3536L16.3536 14.9536L16.7071 14.6L16.3536 14.2464L11.1071 9L16.3536 3.75355L16.7071 3.4L16.3536 3.04645L14.9536 1.64645L14.6 1.29289L14.2464 1.64645L9 6.89289L3.75355 1.64645L3.4 1.29289L3.04645 1.64645L1.64645 3.04645L1.29289 3.4L1.64645 3.75355L6.89289 9L1.64645 14.2464L1.29289 14.6L1.64645 14.9536L3.04645 16.3536Z",stroke:"#303030","stroke-opacity":"0.8","stroke-miterlimit":"10"})],-1),ue=[de],pe={class:"lg:w-7/12"},fe={class:"mb-4"},he=e("label",{for:"name",class:"mb-1 block"},[u(" 商品名稱 "),e("span",{class:"text-danger"},"*")],-1),me={class:"mb-4 flex gap-2"},be={class:"w-1/2"},_e=e("label",{for:"category",class:"mb-1 block"},[u(" 分類 "),e("span",{class:"text-danger"},"*")],-1),ge={class:"w-1/2"},xe=e("label",{for:"unit",class:"mb-1 block"},[u(" 單位 "),e("span",{class:"text-danger"},"*")],-1),we={class:"mb-4 flex gap-2"},ye={class:"w-1/2"},ke=e("label",{for:"origin",class:"mb-1 block"},[u(" 原價 "),e("span",{class:"text-danger"},"*")],-1),ve={class:"w-1/2"},Pe=e("label",{for:"price",class:"mb-1 block font-semibold"},[u(" 售價 "),e("span",{class:"text-danger"},"*")],-1),Le={class:"mb-4"},Me=e("label",{for:"description",class:"mb-1 block"},"商品描述",-1),Ue={class:"mb-4"},Ce=e("label",{for:"content",class:"mb-1 block"},"商品內容",-1),Te={class:"mb-4"},$e=e("label",{for:"tag",class:"mb-1 block"},"＃ tag 標籤",-1),Ie={class:"mb-4"},De={class:"font-semibold text-cerulean"},Ve={class:"flex flex-wrap items-center gap-2"},ze=["onClick"],Se={class:"ml-[2px]"},je=["onClick"],Fe={class:"ml-[2px]"},Ee={class:"mb-4 flex flex-col gap-4"},Be=e("p",{class:"mb-1"},"是否上架",-1),Ae=["checked"],Oe=e("p",{class:"mb-1"},"是否為推薦商品",-1),Ne=["checked"],Re={class:"flex flex-shrink-0 flex-wrap items-center justify-end gap-2 rounded-b-md border-t-2 border-neutral-100 border-opacity-100 p-4"},Ze=e("button",{type:"button",class:"active:bg-cerulean-700 inline-block rounded border border-gray-300 bg-transparent px-[23px] py-[9px] text-right text-sm font-medium uppercase leading-normal text-black transition duration-150 ease-in-out hover:bg-gray-100 hover:opacity-80 focus:outline-none focus:ring-0","data-te-modal-dismiss":""}," 取消 ",-1);function qe(r,o,a,d,t,i){const y=_("ckeditor");return n(),l("div",S,[e("div",j,[e("div",F,[e("div",E,[e("h5",B,f(a.state==="new"?"新增":"編輯")+"商品 ",1),A]),e("div",O,[e("div",N,[e("div",R,[e("div",Z,[e("label",q,[u(" 上傳圖片 "),t.loadingIcon?(n(),l("div",K,X)):v("",!0)]),e("input",{class:"focus:border-primary focus:shadow-te-primary relative m-0 block w-full min-w-0 flex-auto rounded border border-solid border-neutral-300 bg-clip-padding px-3 py-[0.32rem] text-base font-normal text-neutral-700 transition duration-300 ease-in-out file:-mx-3 file:-my-[0.32rem] file:overflow-hidden file:rounded-none file:border-0 file:border-solid file:border-inherit file:bg-neutral-100 file:px-3 file:py-[0.32rem] file:text-neutral-700 file:transition file:duration-150 file:ease-in-out file:[border-inline-end-width:1px] file:[margin-inline-end:0.75rem] hover:file:bg-neutral-200 focus:text-neutral-700 focus:outline-none",type:"file",id:"formFile",ref:"imageFileInput",onChange:o[0]||(o[0]=s=>i.uploadPhoto("file")),disabled:t.loadingIcon},null,40,H)]),e("div",J,[W,e("div",Y,[e("input",{type:"text",class:"focus:border-primary relative m-0 block w-[1px] min-w-0 flex-auto rounded-l border border-r-0 border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"https://",id:"imageUrl","aria-label":"Recipient's username","aria-describedby":"basic-addon2",ref:"imageUrlInput",disabled:t.loadingIcon},null,8,ee),e("button",{type:"button",class:"rounded-r border border-solid border-neutral-300 px-3 py-[0.25rem] text-center text-base font-normal leading-[1.6] text-neutral-700 hover:border-cerulean hover:bg-cerulean hover:text-white",id:"basic-addon2",onClick:o[1]||(o[1]=s=>i.uploadPhoto("button"))}," 新增 ")])]),e("div",te,[oe,t.tempProduct.imageUrl?(n(),l("div",se,[e("img",{class:"aspect-square w-full object-cover object-center",src:t.tempProduct.imageUrl,alt:`${t.tempProduct.title}-主要圖片`,title:`${t.tempProduct.title}-主要圖片`},null,8,re),e("button",{type:"button",class:"material-symbols-outlined absolute right-0 top-0 box-content rounded-none border-none p-2 text-black-light hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none",title:"刪除主要圖片",onClick:o[2]||(o[2]=s=>i.delPhoto(t.tempProduct.imageUrl))},le)])):v("",!0)]),e("ul",ae,[(n(!0),l(w,null,k(t.tempProduct.imagesUrl,(s,p)=>(n(),l("li",{class:"relative w-1/3 p-1",key:`${s.title}${p}`},[e("img",{class:"aspect-square w-full object-cover object-center",src:s,alt:`${t.tempProduct.title}-圖片${p+2}`},null,8,ie),e("button",{type:"button",class:"material-symbols-outlined absolute right-0 top-0 box-content rounded-none border-none p-2 text-black-light hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none",title:`刪除圖片${p+2}`,onClick:P=>i.delPhoto(p)},ue,8,ce)]))),128))])]),e("div",pe,[e("div",fe,[he,h(e("input",{type:"text",class:"focus:border-primary m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入商品名稱",id:"name","onUpdate:modelValue":o[3]||(o[3]=s=>t.tempProduct.title=s)},null,512),[[m,t.tempProduct.title]])]),e("div",me,[e("div",be,[_e,h(e("input",{type:"text",class:"focus:border-primary m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入分類",id:"category","onUpdate:modelValue":o[4]||(o[4]=s=>t.tempProduct.category=s)},null,512),[[m,t.tempProduct.category]])]),e("div",ge,[xe,h(e("input",{type:"text",class:"focus:border-primary m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入單位",id:"unit","onUpdate:modelValue":o[5]||(o[5]=s=>t.tempProduct.unit=s)},null,512),[[m,t.tempProduct.unit]])])]),e("div",we,[e("div",ye,[ke,h(e("input",{type:"number",min:"0",class:"focus:border-primary m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入原價",id:"origin","onUpdate:modelValue":o[6]||(o[6]=s=>t.tempProduct.origin_price=s)},null,512),[[m,t.tempProduct.origin_price]])]),e("div",ve,[Pe,h(e("input",{type:"number",min:"0",class:"focus:border-primary m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入售價",id:"price","onUpdate:modelValue":o[7]||(o[7]=s=>t.tempProduct.price=s)},null,512),[[m,t.tempProduct.price]])])]),e("div",Le,[Me,b(y,{editor:t.editor,modelValue:t.tempProduct.description,"onUpdate:modelValue":o[8]||(o[8]=s=>t.tempProduct.description=s),config:t.editorConfig,id:"description"},null,8,["editor","modelValue","config"])]),e("div",Ue,[Ce,b(y,{editor:t.editor,modelValue:t.tempProduct.content,"onUpdate:modelValue":o[9]||(o[9]=s=>t.tempProduct.content=s),config:t.editorConfig,id:"content"},null,8,["editor","modelValue","config"])]),e("div",Te,[$e,h(e("input",{type:"text",class:"focus:border-primary m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"不用加前綴「＃」，直接輸入名稱即可",id:"tag","onUpdate:modelValue":o[10]||(o[10]=s=>t.tempTag=s),onKeydown:o[11]||(o[11]=I(s=>i.pushTag(),["enter"]))},null,544),[[m,t.tempTag]])]),e("div",Ie,[e("div",De,[e("div",Ve,[(n(!0),l(w,null,k(a.allTags,s=>(n(),l("button",{type:"button",class:g(["rounded-full border border-cerulean px-2 py-2 text-sm leading-3 hover:bg-cerulean hover:text-white",{"bg-cerulean text-white":t.tempProduct.tag&&t.tempProduct.tag.includes(s)}]),key:s,onClick:p=>i.selectTag(s)},[u(" ＃ "),e("span",Se,f(s),1)],10,ze))),128)),(n(!0),l(w,null,k(t.tempProduct.tag,s=>(n(),l("button",{type:"button",class:g(["rounded-full bg-cerulean px-2 py-2 text-sm leading-3 text-white",{hidden:a.allTags.some(p=>p===s)}]),key:s,onClick:p=>i.selectTag(s)},[u(" ＃ "),e("span",Fe,f(s),1)],10,je))),128))])])]),e("div",Ee,[e("div",null,[Be,h(e("input",{class:"mr-2 mt-[0.3rem] h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-success checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-neutral-100 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-success checked:focus:bg-success checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",checked:t.tempProduct.is_enabled,"onUpdate:modelValue":o[12]||(o[12]=s=>t.tempProduct.is_enabled=s)},null,8,Ae),[[L,t.tempProduct.is_enabled]]),e("label",{class:g(["inline-block pl-[0.15rem] hover:cursor-pointer",t.tempProduct.is_enabled?"text-success":"text-gray-400"]),for:"flexSwitchCheckDefault"},f(t.tempProduct.is_enabled?"上架中":"未上架"),3)]),e("div",null,[Oe,h(e("input",{class:"mr-2 mt-[0.3rem] h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-success checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-neutral-100 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-success checked:focus:bg-success checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"switchCheckRecommend",checked:t.tempProduct.is_recommend,"onUpdate:modelValue":o[13]||(o[13]=s=>t.tempProduct.is_recommend=s)},null,8,Ne),[[L,t.tempProduct.is_recommend]]),e("label",{class:g(["inline-block pl-[0.15rem] hover:cursor-pointer",t.tempProduct.is_recommend?"text-success":"text-gray-400"]),for:"switchCheckRecommend"},f(t.tempProduct.is_recommend?"推薦":"未開啟"),3)])])])])]),e("div",Re,[Ze,e("button",{type:"button",class:"active:bg-cerulean-700 inline-block rounded bg-cerulean px-6 py-2.5 text-right text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out hover:opacity-80 focus:outline-none focus:ring-0",onClick:o[14]||(o[14]=s=>r.$emit("update-products",this.tempProduct))}," 確認 ")])])])],512)}const Ke=M(z,[["render",qe]]),Ge={data(){return{products:[],tempProduct:{},productModalState:"edit",pagination:{},allTags:[],isLoading:!1}},methods:{getProducts(r=1){this.isLoading=!0;const o=`https://vue3-course-api.hexschool.io/api/yu-api/admin/products?page=${r}`;this.$http.get(o).then(a=>{a.data.success&&(this.products=a.data.products,this.pagination=a.data.pagination,this.getTags(),this.isLoading=!1)})},getTags(){this.allTags=[],this.products.forEach(r=>{Object.prototype.hasOwnProperty.call(r,"tag")&&this.allTags.push(...r.tag)}),this.allTags=this.allTags.filter((r,o,a)=>a.indexOf(r)===o)},updateProduct(r){const o=Math.floor(new Date().getTime()/1e3);this.tempProduct.lastEditDate=o;let a="post",d="https://vue3-course-api.hexschool.io/api/yu-api/admin/product";this.productModalState==="edit"&&(this.tempProduct=r,a="put",d=`https://vue3-course-api.hexschool.io/api/yu-api/admin/product/${r.id}`),this.$http[a](d,{data:this.tempProduct}).then(t=>{const i=x();t.data.success?(this.$refs.productModal.hideModal(),this.getProducts(this.pagination.current_page),this.tempProduct={},i.pushToastMessage(t.data.success,`${this.productModalState==="new"?"新增":"編輯"}成功`)):i.pushToastMessage(t.data.success,`${this.productModalState==="new"?"新增":"編輯"}失敗`,t.data.message)})},openModal(r,o){if(this.productModalState=r,this.tempProduct={...o},r==="del"){this.$refs.delModal.showModal();return}r==="new"&&(this.tempProduct={}),this.$refs.productModal.showModal()},delProduct(r){const o=x(),a=`https://vue3-course-api.hexschool.io/api/yu-api/admin/product/${r.id}`;this.$http.delete(a).then(d=>{d.data.success?(this.$refs.delModal.hideModal(),this.getProducts(),o.pushToastMessage(d.data.success,"刪除成功")):o.pushToastMessage(d.data.success,"刪除失敗",d.data.message)})}},created(){this.getProducts()},components:{ProductModal:Ke,DelModal:D,Pagination:V}},Qe={class:"ml-0 lg:ml-[310px]"},Xe={class:"container flex justify-between py-4 lg:mt-10 lg:text-right"},He=e("h2",{class:"flex items-center font-noto-serif text-3xl text-black"},[e("span",{class:"material-symbols-outlined mr-2 text-4xl text-black-light"},"Lists"),u(" 商品列表 ")],-1),Je=e("span",{class:"material-symbols-outlined"},"add",-1),We={class:"container mb-11 flex min-h-[679px] flex-col"},Ye={class:"overflow-x-auto"},et={class:"inline-block min-w-full py-2"},tt={class:"overflow-hidden"},ot={class:"min-w-full text-left text-sm font-light"},st=e("thead",{class:"break-keep border-b border-gray-400 font-medium"},[e("tr",null,[e("th",{scope:"col",class:"w-[10%] px-6 py-4"},"類別"),e("th",{scope:"col",class:"px-6 py-4"},"商品名稱"),e("th",{scope:"col",class:"w-[10%] px-6 py-4"},"原價"),e("th",{scope:"col",class:"w-[10%] px-6 py-4"},"售價"),e("th",{scope:"col",class:"w-[10%] px-6 py-4"},"上架"),e("th",{scope:"col",class:"w-[10%] px-6 py-4"},"最後更新時間"),e("th",{scope:"col",class:"w-[10%] px-6 py-4"},"編輯")])],-1),rt={class:"whitespace-nowrap px-6 py-4"},nt={class:"whitespace-nowrap px-6 py-4 font-normal"},lt={class:"flex items-center"},at=["src"],it={key:1,class:"material-symbols-outlined mr-2 text-[28px]"},ct={key:2,class:"ml-2 rounded-full bg-success px-2 font-montserrat text-[8px] leading-3 text-white"},dt={class:"whitespace-nowrap px-6 py-4 font-normal text-gray-400"},ut={class:"whitespace-nowrap px-6 py-4 font-normal"},pt={class:"whitespace-nowrap px-6 py-4 font-normal"},ft={key:0,class:"font-normal text-success"},ht={key:1,class:"text-gray-400"},mt={class:"whitespace-nowrap px-6 py-4"},bt={key:0},_t={key:1},gt={class:"whitespace-nowrap px-6 py-4"},xt=["onClick"],wt=e("span",{class:"material-symbols-outlined",style:{"font-variation-settings":`'FILL' 1,
                            'wght' 400,
                            'GRAD' 0,
                            'opsz' 24`}}," edit ",-1),yt=[wt],kt=["onClick"],vt=e("span",{class:"material-symbols-outlined"},"delete",-1),Pt=[vt];function Lt(r,o,a,d,t,i){const y=_("LoadingAnimation"),s=_("ProductModal"),p=_("DelModal"),P=_("Pagination");return n(),l(w,null,[b(y,{active:t.isLoading,"lock-scroll":!0},null,8,["active"]),e("main",Qe,[e("div",Xe,[He,e("button",{type:"button",class:"active:bg-cerulean-700 my-auto flex items-center rounded bg-cerulean px-6 py-2.5 text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out hover:opacity-80 focus:outline-none focus:ring-0",onClick:o[0]||(o[0]=c=>i.openModal("new"))},[Je,u(" 新增商品 ")])]),e("div",We,[e("div",Ye,[e("div",et,[e("div",tt,[e("table",ot,[st,e("tbody",null,[(n(!0),l(w,null,k(t.products,c=>(n(),l("tr",{key:c.id,class:g(["border-b transition duration-300 ease-in-out hover:bg-neutral-100",{"bg-[#f2f2f2]":!c.is_enabled}])},[e("th",rt,f(c.category),1),e("td",nt,[e("div",lt,[c.imageUrl?(n(),l("img",{key:0,src:c.imageUrl,alt:"",class:"mr-2 h-[28px] w-[28px] object-cover"},null,8,at)):(n(),l("span",it,"image")),u(" "+f(c.title)+" ",1),c.origin_price!==c.price?(n(),l("span",ct,"SALE ")):v("",!0)])]),e("td",dt," $ "+f(r.$filters.currency(c.origin_price)),1),e("td",ut,"$ "+f(r.$filters.currency(c.price)),1),e("td",pt,[c.is_enabled?(n(),l("p",ft,"上架")):(n(),l("p",ht,"未上架"))]),e("td",mt,[c.lastEditDate?(n(),l("p",bt,f(r.$filters.date(c.lastEditDate)),1)):(n(),l("p",_t,"無紀錄"))]),e("td",gt,[e("button",{type:"button",class:"inline-block pr-4 hover:text-cerulean",onClick:U=>i.openModal("edit",c)},yt,8,xt),e("button",{type:"button",class:"inline-block px-4 hover:text-danger",onClick:U=>i.openModal("del",c)},Pt,8,kt)])],2))),128))])])])])])]),b(s,{product:t.tempProduct,state:t.productModalState,allTags:t.allTags,onUpdateProducts:i.updateProduct,ref:"productModal"},null,8,["product","state","allTags","onUpdateProducts"]),b(p,{ref:"delModal",onDel:i.delProduct,item:t.tempProduct},null,8,["onDel","item"]),b(P,{pages:t.pagination,onChangePage:i.getProducts},null,8,["pages","onChangePage"])])],64)}const Dt=M(Ge,[["render",Lt]]);export{Dt as default};
