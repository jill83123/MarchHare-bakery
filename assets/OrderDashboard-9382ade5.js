import{_ as O,o as a,d,e,l as u,v as _,N as D,n as h,t as l,L,h as c,i as f,F as w,j as M,g,p as S,b as V,r as m,f as b}from"./index-fa6b6820.js";import{s as j}from"./statesStore-f5b79357.js";import{P as z,D as E}from"./PaginationBackend-a68438ba.js";import{_ as k}from"./tw-elements.es.min-5f64f089.js";import{m as A}from"./modalMixin-e43cb9db.js";const N={data(){return{tempOrder:{user:{order:{}},products:{}},selectEl:{}}},watch:{item(){this.tempOrder=this.item,k.getOrCreateInstance(this.selectEl).setValue(this.tempOrder.user.order.status)}},props:["item"],mixins:[A],mounted(){this.selectEl=this.$refs.statusSelect,k.getOrCreateInstance(this.selectEl)}},T={"data-te-modal-init":"",class:"fixed left-0 top-0 z-[1055] hidden h-full w-full overflow-y-auto overflow-x-hidden outline-none",id:"exampleModalXl",tabindex:"-1","aria-labelledby":"exampleModalXlLabel","aria-modal":"true",role:"dialog",ref:"modal"},U={"data-te-modal-dialog-ref":"",class:"pointer-events-none relative w-auto translate-y-[-50px] opacity-0 transition-all duration-300 ease-in-out mx-auto mt-7 max-w-[500px] min-[992px]:max-w-[800px] min-[1200px]:max-w-[1180px]"},P={class:"max-h-[calc(100vh_-_56px)] relative flex flex-col w-full text-current bg-white border-none rounded-md shadow-lg outline-none pointer-events-auto bg-clip-padding dark:bg-neutral-600"},B=S('<div class="flex items-center justify-between flex-shrink-0 p-4 border-b-2 border-opacity-100 rounded-t-md border-neutral-100 dark:border-opacity-50"><h5 class="text-xl font-medium leading-normal text-neutral-800 dark:text-neutral-200" id="exampleModalXlLabel"> 編輯訂單 </h5><button type="button" class="box-content border-none rounded-none hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none" data-te-modal-dismiss aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>',1),F={key:0,class:"relative p-4 overflow-y-scroll"},q={class:"flex-col min-[1200px]:flex-row flex pt-4 pb-6"},I={class:"min-[1200px]:w-1/3"},X={class:"h-full px-2"},G={class:"flex gap-2 mb-4"},R={class:"w-1/2"},H=e("label",{for:"name",class:"block mb-1"},"收件人姓名",-1),J={class:"w-1/2"},K=e("label",{for:"tel",class:"block mb-1"},"收件人電話",-1),Q={class:"mb-4"},W=e("label",{for:"mail",class:"block mb-1"},"E-mail",-1),Y={class:"mb-4"},Z=e("label",{for:"address",class:"block mb-1"},"地址",-1),ee={class:"pb-4 mb-4"},te=e("label",{for:"message",class:"block mb-1"},"留言",-1),se=["checked"],oe={class:"min-[1200px]:w-2/3"},re={class:"flex items-end justify-end mb-6"},le={class:"w-[170px] text-gray-500"},ne=e("label",{for:"statusSelect",class:"text-sm"},"訂單狀態",-1),ae=e("option",{value:"收到訂單",selected:""},"收到訂單",-1),de=e("option",{value:"準備中"},"準備中",-1),ie=e("option",{value:"已完成（寄出）"},"已完成（寄出）",-1),ce=e("option",{value:"已取貨"},"已取貨",-1),pe=[ae,de,ie,ce],ue={class:"overflow-x-auto max-h-[calc(100vh_-_280px)]"},_e={class:"inline-block min-w-full py-2 sm:px-3"},he={class:"overflow-hidden"},fe={class:"min-w-full overflow-y-scroll text-sm text-left"},xe={class:"font-medium text-black border-b border-gray-400"},me=e("th",{scope:"col",class:"w-[5%] px-1 py-4 md:px-4"},"#",-1),be=e("th",{scope:"col",class:"max-[500px]:w-[45%] px-1 py-4 md:px-4"},"清單",-1),ge={scope:"col",class:"max-[500px]:w-[35%] w-[25%] px-1 py-4 md:px-4"},ye={key:0,class:"block -ml-2 text-xs text-success"},we=e("th",{scope:"col",class:"w-[10%] px-0 py-4 md:px-4"},"數量",-1),ve={class:"text-black-light"},ke={class:"px-2 py-4 font-medium md:px-4"},Oe={class:"px-1 py-4 md:px-4"},Me={class:"flex flex-col gap-2 md:gap-8 min-[500px]:flex-row"},$e=["src","alt"],Ce={class:"flex flex-col justify-center"},De={class:"mb-2"},Le={class:"inline-block mb-1 mr-1 font-medium text-black lg:text-xl"},Se={key:0,class:"px-2 ml-2 text-xs text-white rounded-full font-montserrat op bg-success"},Ve=e("br",null,null,-1),je={class:"px-2 py-4 text-xs tracking-wider max-[500px]:text-center sm:text-left sm:text-sm md:px-4"},ze=e("span",{class:"hidden mr-[2px] sm:inline-block"},"NT ",-1),Ee={class:"px-2 py-4 md:px-4"},Ae={class:"flex items-center"},Ne={class:"hidden pl-2 text-sm text-gray-400 sm:inline-block"},Te={class:"text-base font-bold tracking-wider border-t border-gray-200 text-brown-500"},Ue={class:"px-1 py-4 md:px-4",colspan:"2"},Pe={class:"flex items-center justify-between"},Be={class:"text-gray-500"},Fe={class:"px-1 py-4 text-center md:text-start md:px-4",colspan:"3"},qe={class:"-ml-2 text-sm"},Ie={class:"flex flex-wrap items-center justify-end flex-shrink-0 gap-2 p-4 border-t-2 border-opacity-100 rounded-b-md border-neutral-100"},Xe=e("button",{type:"button",class:"inline-block px-[23px] py-[9px] text-sm font-medium leading-normal text-right text-black uppercase transition duration-150 ease-in-out bg-transparent border border-gray-300 rounded focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80 hover:bg-gray-100","data-te-modal-dismiss":""}," 取消 ",-1);function Ge(r,o,i,x,s,p){return a(),d("div",T,[e("div",U,[e("div",P,[B,s.tempOrder?(a(),d("div",F,[e("div",q,[e("div",I,[e("div",X,[e("div",G,[e("div",R,[H,u(e("input",{type:"text",class:"m-0 block w-full border border-solid rounded border-neutral-300 bg-clip-padding px-3 py-[6px] text-base font-normal leading-[1.6] text-black outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",id:"name","onUpdate:modelValue":o[0]||(o[0]=t=>s.tempOrder.user.name=t)},null,512),[[_,s.tempOrder.user.name]])]),e("div",J,[K,u(e("input",{type:"tel",class:"m-0 block w-full border border-solid rounded border-neutral-300 bg-clip-padding px-3 py-[6px] text-base font-normal leading-[1.6] text-black outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",id:"tel","onUpdate:modelValue":o[1]||(o[1]=t=>s.tempOrder.user.tel=t)},null,512),[[_,s.tempOrder.user.tel]])])]),e("div",Q,[W,u(e("input",{type:"email",class:"m-0 block w-full border border-solid rounded border-neutral-300 bg-clip-padding px-3 py-[6px] text-base font-normal leading-[1.6] text-black outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",id:"mail","onUpdate:modelValue":o[2]||(o[2]=t=>s.tempOrder.user.email=t)},null,512),[[_,s.tempOrder.user.email]])]),e("div",Y,[Z,u(e("input",{type:"text",class:"m-0 block w-full border border-solid rounded border-neutral-300 bg-clip-padding px-3 py-[6px] text-base font-normal leading-[1.6] text-black outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",id:"address","onUpdate:modelValue":o[3]||(o[3]=t=>s.tempOrder.user.address=t)},null,512),[[_,s.tempOrder.user.address]])]),e("div",ee,[te,u(e("textarea",{type:"text",class:"min-h-[100px] resize-none m-0 block w-full rounded border border-solid border-neutral-300 bg-clip-padding px-3 py-[6px] text-base font-normal leading-[1.6] text-black outline-none transition duration-200 ease-in-out focus:z-[3] focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",id:"message","onUpdate:modelValue":o[4]||(o[4]=t=>s.tempOrder.message=t)},null,512),[[_,s.tempOrder.message]])]),e("div",null,[u(e("input",{class:"mr-2 mt-[0.3rem] h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-success checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-neutral-100 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-success checked:focus:bg-success checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",checked:s.tempOrder.user.order.is_paid,"onUpdate:modelValue":o[5]||(o[5]=t=>s.tempOrder.user.order.is_paid=t)},null,8,se),[[D,s.tempOrder.user.order.is_paid]]),e("label",{class:h(["inline-block pl-[0.15rem] hover:cursor-pointer ml-1 font-semibold",s.tempOrder.user.order.is_paid?" text-success":" text-danger"]),for:"flexSwitchCheckDefault"},l(s.tempOrder.user.order.is_paid?"已付款":"尚未付款"),3)])])]),e("div",oe,[e("div",re,[e("div",le,[ne,u(e("select",{"data-te-select-init":"","data-te-class-select-Label":"data-[te-input-state-active]:scale-1 absolute top-[18%] left-[5%] pointer-events-none",id:"statusSelect","onUpdate:modelValue":o[6]||(o[6]=t=>s.tempOrder.user.order.status=t),ref:"statusSelect"},pe,512),[[L,s.tempOrder.user.order.status]])])]),e("div",ue,[e("div",_e,[e("div",he,[e("table",fe,[e("thead",xe,[e("tr",null,[me,be,e("th",ge,[c("小計 "),Object.values(s.tempOrder.products).some(t=>t.coupon)?(a(),d("span",ye,l(Object.values(s.tempOrder.products).some(t=>t.coupon)?"（已使用優惠券）":""),1)):f("",!0)]),we])]),e("tbody",ve,[(a(!0),d(w,null,M(s.tempOrder.products,(t,v,y)=>(a(),d("tr",{class:"border-b border-gray-200 hover:bg-neutral-100",key:t.id},[e("td",ke,l(y+1),1),e("td",Oe,[e("div",Me,[e("img",{class:"w-full min-[500px]:w-[130px] object-cover",src:t.product.imageUrl,alt:t.product.title},null,8,$e),e("div",Ce,[e("div",De,[e("h4",Le,l(t.product.title),1),t.product.price!==t.product.origin_price?(a(),d("span",Se,"SALE")):f("",!0),Ve,e("span",{class:h(["text-xs tracking-wider text-gray-500",{"line-through":t.product.price!==t.product.origin_price}])},"NT "+l(r.$filters.currency(t.product.origin_price))+" 元",3),t.product.price!==t.product.origin_price?(a(),d("span",{key:1,class:h(["text-xs tracking-wider text-gray-500",{" text-success font-bold ml-2":t.product.price!==t.product.origin_price}])},[c("NT "),e("span",null,l(r.$filters.currency(t.product.price)),1),c(" 元")],2)):f("",!0)])])])]),e("td",je,[e("span",{class:h({"text-success font-bold":t.total!==t.final_total})},[ze,e("span",null,l(t.total===t.final_total?r.$filters.currency(t.total*t.qty):r.$filters.currency(t.final_total)),1),c(" 元 ")],2)]),e("td",Ee,[e("div",Ae,[c(l(t.product.qty?t.product.qty:1)+" ",1),e("span",Ne,l(t.product.unit),1)])])]))),128))]),e("tfoot",Te,[e("td",Ue,[e("div",Pe,[c(l(Object.keys(s.tempOrder.products).length)+" 個商品 ",1),e("div",Be,l(s.tempOrder.user.order.pickupMethod==="delivery"?"宅配":"到店自取"),1)])]),e("td",Fe,[c(" 共 NT "+l(r.$filters.currency(s.tempOrder.total))+" 元 ",1),e("p",qe,l(s.tempOrder.user.order.pickupMethod==="delivery"?"（含運費 80 元）":""),1)])])])])])])])])])):f("",!0),e("div",Ie,[Xe,e("button",{type:"button",class:"inline-block rounded bg-cerulean px-6 py-2.5 text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80 text-right",onClick:o[7]||(o[7]=g(t=>r.$emit("update-order",this.tempOrder),["prevent"]))}," 確認 ")])])])],512)}const Re=O(N,[["render",Ge]]),He={data(){return{orderList:[],tempOrder:{},orderModalState:"",pagination:{},isLoading:!1}},methods:{...V(j,["pushToastMessage"]),getOrders(r=1){this.isLoading=!0;const o=`https://vue3-course-api.hexschool.io/api/yu-api/admin/orders?page=${r}`;this.$http.get(o).then(i=>{i.data.success&&(this.orderList=i.data.orders,this.pagination=i.data.pagination,this.isLoading=!1)})},updateOrder(){const r=Math.floor(new Date().getTime()/1e3);this.tempOrder.lastEditDate=r;const o=`https://vue3-course-api.hexschool.io/api/yu-api/admin/order/${this.tempOrder.id}`,i={data:{...this.tempOrder}};this.$http.put(o,i).then(x=>{x.data.success&&(this.getOrders(),this.$refs.orderModal.hideModal(),this.pushToastMessage(x.data.success,"更新成功"))})},openModal(r,o){if(this.orderModalState=r,(r==="edit"||r==="del")&&(this.tempOrder={...o}),r==="del"||r==="delAll"){this.tempOrder.title="訂單",r==="delAll"&&(this.tempOrder.title="全部"),this.$refs.delModal.showModal();return}this.$refs.orderModal.showModal()},delOrder(r){let o=`https://vue3-course-api.hexschool.io/api/yu-api/admin/order/${r.id}`;this.orderModalState==="delAll"&&(o="https://vue3-course-api.hexschool.io/api/yu-api/admin/orders/all"),this.$http.delete(o).then(i=>{i.data.success&&(this.getOrders(),this.$refs.delModal.hideModal(),this.pushToastMessage(i.data.success,"刪除成功"))})},delAllOrder(){}},created(){this.getOrders()},components:{Pagination:z,OrderModal:Re,DelModal:E}},Je={class:"ml-0 lg:ml-[310px]"},Ke={class:"container flex justify-between py-4 lg:mt-10 lg:text-right"},Qe=e("h2",{class:"flex items-center text-3xl text-black font-noto-serif"},[e("span",{class:"mr-2 text-4xl text-black-light material-symbols-outlined"}," Contract_Edit "),c("訂單管理")],-1),We=e("span",{class:"mr-2 -ml-1 material-symbols-outlined"}," Delete_Forever ",-1),Ye={class:"container flex flex-col mb-11 min-h-[679px]"},Ze={class:"overflow-x-auto"},et={class:"inline-block min-w-full py-2"},tt={class:"overflow-hidden"},st={class:"min-w-full text-sm font-light text-left"},ot=e("thead",{class:"font-medium border-b border-gray-400 break-keep"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 w-[1%]"},"#"),e("th",{scope:"col",class:"px-6 py-4"},"訂單狀態"),e("th",{scope:"col",class:"px-6 py-4"},"成立時間"),e("th",{scope:"col",class:"px-6 py-4"},"訂單編號"),e("th",{scope:"col",class:"px-6 py-4"},"姓名"),e("th",{scope:"col",class:"px-6 py-4"},"電話"),e("th",{scope:"col",class:"px-6 py-4"},"取貨方式"),e("th",{scope:"col",class:"px-6 py-4"},"付款狀態"),e("th",{scope:"col",class:"px-6 py-4"},"最後更新時間"),e("th",{scope:"col",class:"px-6 py-4"},"編輯")])],-1),rt={class:"px-6 py-4 whitespace-nowrap"},lt={class:"px-6 py-4 whitespace-nowrap"},nt={class:"px-6 py-4 whitespace-nowrap"},at={class:"px-6 py-4 whitespace-nowrap"},dt={class:"px-6 py-4 whitespace-nowrap"},it={class:"px-6 py-4 whitespace-nowrap"},ct={class:"px-6 py-4 whitespace-nowrap"},pt={class:"px-6 py-4 whitespace-nowrap"},ut={key:0},_t={class:"px-6 py-4 whitespace-nowrap"},ht=["onClick"],ft=e("span",{class:"material-symbols-outlined",style:{"font-variation-settings":`'FILL' 1,\r
                            'wght' 400,\r
                            'GRAD' 0,\r
                            'opsz' 24`}}," edit ",-1),xt=[ft],mt=["onClick"],bt=e("span",{class:"material-symbols-outlined"},"delete",-1),gt=[bt];function yt(r,o,i,x,s,p){const t=m("LoadingAnimation"),v=m("Pagination"),y=m("OrderModal"),$=m("DelModal");return a(),d(w,null,[b(t,{active:s.isLoading},null,8,["active"]),e("main",Je,[e("div",Ke,[Qe,e("button",{type:"button",class:"my-auto flex items-center rounded bg-cerulean px-6 py-2.5 text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80",onClick:o[0]||(o[0]=g(n=>p.openModal("delAll",r.item),["prevent"]))},[We,c("刪除全部 ")])]),e("div",Ye,[e("div",Ze,[e("div",et,[e("div",tt,[e("table",st,[ot,e("tbody",null,[(a(!0),d(w,null,M(s.orderList,n=>(a(),d("tr",{key:n.id,class:"font-normal transition duration-300 ease-in-out border-b hover:bg-neutral-100"},[e("th",rt,l(n.num),1),e("td",lt,l(n.user.order.status),1),e("td",nt,l(r.$filters.date(n.create_at)),1),e("td",at,l(n.id),1),e("td",dt,l(n.user.name),1),e("td",it,l(n.user.tel),1),e("td",ct,l(n.user.order.pickupMethod==="self"?"到店自取":"宅配"),1),e("td",{class:h(["px-6 py-4 font-bold whitespace-nowrap",n.user.order.is_paid?"text-success":"text-danger"])},l(n.user.order.is_paid?"已付款":"未付款"),3),e("td",pt,[n.lastEditDate?(a(),d("p",ut,l(r.$filters.date(n.lastEditDate)),1)):f("",!0)]),e("td",_t,[e("button",{class:"inline-block pr-4 hover:text-cerulean",onClick:g(C=>p.openModal("edit",n),["prevent"])},xt,8,ht),e("button",{class:"inline-block px-4 hover:text-danger",onClick:g(C=>p.openModal("del",n),["prevent"])},gt,8,mt)])]))),128))])])])])])]),b(v,{pages:s.pagination,onChangePage:p.getOrders},null,8,["pages","onChangePage"]),b(y,{ref:"orderModal",onUpdateOrder:p.updateOrder,item:s.tempOrder},null,8,["onUpdateOrder","item"]),b($,{ref:"delModal",onDel:p.delOrder,item:s.tempOrder},null,8,["onDel","item"])])],64)}const $t=O(He,[["render",yt]]);export{$t as default};
