import{s as g}from"./statesStore-0438c3a5.js";import{a as $,b as w,V as D}from"./tw-elements.es.min-5f64f089.js";import{m as S}from"./modalMixin-e43cb9db.js";import{_ as k,o as d,c,d as e,t as u,k as h,v as _,f,P as L,g as p,r as b,e as x,F as y,i as T}from"./index-200782e0.js";import{D as z,P as V}from"./PaginationBackend-5a4af5b9.js";const P={props:{coupon:{type:Object,default(){return{tempCoupon:{}}}},state:{type:String}},watch:{coupon(){this.tempCoupon=this.coupon}},data(){return{tempCoupon:{},datepicker:{},loadingIcon:!1}},methods:{date(){this.datepicker.open()}},mounted(){$({Datepicker:w,Input:D}),this.datepicker=new w(this.$refs.due_date,{disablePast:!0})},created(){},mixins:[S]},U={"data-te-modal-init":"",class:"fixed left-0 top-0 z-[1055] hidden h-full w-full overflow-y-auto overflow-x-hidden outline-none",id:"addModal",tabindex:"-1","aria-labelledby":"productModal","aria-modal":"true",role:"dialog","data-te-backdrop":"static",ref:"modal"},j={"data-te-modal-dialog-ref":"",class:"pointer-events-none relative w-auto translate-y-[-50px] opacity-0 transition-all duration-300 ease-in-out min-[576px]:mx-auto mt-7 min-[576px]:max-w-[800px] px-2 sm:px-5"},E={class:"relative flex flex-col w-full text-current bg-white border-none rounded-md shadow-lg outline-none pointer-events-auto bg-clip-padding max-h-[94vh] lg:max-h-[90vh]"},B={class:"flex items-center justify-between flex-shrink-0 p-4 border-b-2 border-opacity-100 rounded-t-md border-neutral-100"},N={class:"text-xl font-medium leading-normal text-neutral-800",id:"exampleModalXlLabel"},A=e("button",{type:"button",class:"box-content border-none rounded-none hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none","data-te-modal-dismiss":"","aria-label":"Close"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1),F={class:"relative p-4 overflow-y-auto"},I={class:"flex gap-2 mb-4"},Z={class:"w-1/2"},G=e("label",{for:"name",class:"block mb-1"},[p("優惠名稱"),e("span",{class:"text-danger"}," *")],-1),O={class:"w-1/2"},R=e("label",{for:"number",class:"block mb-1"},[p("優惠碼"),e("span",{class:"text-danger"}," *")],-1),X={class:"flex gap-2 mb-4"},q={class:"w-1/2"},H=e("label",{for:"discount",class:"block mb-1"},[p("折扣百分比"),e("span",{class:"text-danger"}," *")],-1),J={class:"w-1/2"},K=e("label",{for:"date",class:"block mb-1"},[p("到期日"),e("span",{class:"text-danger"}," *")],-1),Q={class:"relative mb-3","data-te-inline":"true","data-te-format":"yyyy-mm-dd","data-te-class-datepicker-cell-content":"group-[[data-te-datepicker-cell-selected]]:font-black",ref:"due_date"},W=["checked"],Y=e("label",{class:"inline-block pl-[0.15rem] hover:cursor-pointer",for:"flexSwitchCheckDefault"},[p("是否啟用"),e("span",{class:"text-danger"}," *")],-1),ee={class:"flex flex-wrap items-center justify-end flex-shrink-0 gap-2 p-4 border-t-2 border-opacity-100 rounded-b-md border-neutral-100"},te=e("button",{type:"button",class:"inline-block px-[23px] py-[9px] text-sm font-medium leading-normal text-right text-black uppercase transition duration-150 ease-in-out bg-transparent border border-gray-300 rounded focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80 hover:bg-gray-100","data-te-modal-dismiss":""}," 取消 ",-1);function oe(n,t,i,r,o,a){return d(),c("div",U,[e("div",j,[e("div",E,[e("div",B,[e("h5",N,u(i.state==="new"?"新增":"編輯")+"優惠券 ",1),A]),e("div",F,[e("div",null,[e("div",I,[e("div",Z,[G,h(e("input",{type:"text",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入優惠名稱",id:"name","onUpdate:modelValue":t[0]||(t[0]=s=>o.tempCoupon.title=s)},null,512),[[_,o.tempCoupon.title]])]),e("div",O,[R,h(e("input",{type:"text",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入優惠號碼",id:"number","onUpdate:modelValue":t[1]||(t[1]=s=>o.tempCoupon.code=s)},null,512),[[_,o.tempCoupon.code]])])]),e("div",X,[e("div",q,[H,h(e("input",{type:"number",min:"0",max:"100",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入數字，預設為 100",id:"discount","onUpdate:modelValue":t[2]||(t[2]=s=>o.tempCoupon.percent=s)},null,512),[[_,o.tempCoupon.percent]])]),e("div",J,[K,e("div",Q,[h(e("input",{type:"text",class:"m-0 border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none peer block min-h-[auto] w-full rounded leading-[1.6] focus:placeholder:opacity-100 peer-focus:text-primary data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none :placeholder:opacity-0",placeholder:"請選擇到期日",id:"date","onUpdate:modelValue":t[3]||(t[3]=s=>o.tempCoupon.date=s),onClick:t[4]||(t[4]=f((...s)=>a.date&&a.date(...s),["prevent"]))},null,512),[[_,o.tempCoupon.date]])],512)])]),e("div",null,[h(e("input",{class:"mr-2 mt-[0.3rem] h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-success checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-neutral-100 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-success checked:focus:bg-success checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",checked:o.tempCoupon.is_enabled,"onUpdate:modelValue":t[5]||(t[5]=s=>o.tempCoupon.is_enabled=s)},null,8,W),[[L,o.tempCoupon.is_enabled]]),Y])])]),e("div",ee,[te,e("button",{type:"button",class:"inline-block rounded bg-cerulean px-6 py-2.5 text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80 text-right",onClick:t[6]||(t[6]=f(s=>n.$emit("update-coupons",this.tempCoupon),["prevent"]))}," 確認 ")])])])],512)}const se=k(P,[["render",oe]]),ne={data(){return{coupons:[],tempCoupon:{},couponModalState:"",pagination:{},isLoading:!1}},methods:{getCoupons(n=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/yu-api/admin/coupons?page=${n}`;this.$http.get(t).then(i=>{i.data.success&&(this.coupons=i.data.coupons,this.pagination=i.data.pagination,this.isLoading=!1)})},updateCoupons(n){this.tempCoupon=n,this.tempCoupon.is_enabled===void 0&&(this.tempCoupon.is_enabled=!1),this.tempCoupon.is_enabled=this.tempCoupon.is_enabled?1:0;const t=Math.floor(new Date().getTime()/1e3);this.tempCoupon.lastEditDate=t;const i=this.tempCoupon.date,r=new Date(`${i}T00:00:00Z`);this.tempCoupon.due_date=Math.floor(r.getTime()/1e3);let o="post",a="https://vue3-course-api.hexschool.io/api/yu-api/admin/coupon";this.couponModalState==="edit"&&(o="put",a=`https://vue3-course-api.hexschool.io/api/yu-api/admin/coupon/${n.id}`),this.$http[o](a,{data:this.tempCoupon}).then(s=>{const m=g();s.data.success?(this.$refs.couponModal.hideModal(),this.getCoupons(),this.tempCoupon={},m.pushToastMessage(s.data.success,`${this.couponModalState==="new"?"新增":"編輯"}成功`)):m.pushToastMessage(s.data.success,`${this.couponModalState==="new"?"新增":"編輯"}失敗`,s.data.message)})},openModal(n,t){if(this.couponModalState=n,n==="edit"||n==="del"?this.tempCoupon={...t}:n==="new"&&(this.tempCoupon={}),n==="del"){this.$refs.delModal.showModal();return}this.$refs.couponModal.showModal()},delCoupon(n){const t=g(),i=`https://vue3-course-api.hexschool.io/api/yu-api/admin/coupon/${n.id}`;this.$http.delete(i).then(r=>{r.data.success?(this.$refs.delModal.hideModal(),this.getCoupons(),t.pushToastMessage(r.data.success,"刪除成功")):t.pushToastMessage(r.data.success,"刪除失敗",r.data.message)})}},created(){this.getCoupons()},components:{CouponModal:se,DelModal:z,Pagination:V}},ae={class:"ml-0 lg:ml-[310px]"},le={class:"container flex justify-between py-4 lg:mt-10 lg:text-right"},ie=e("h2",{class:"flex items-center text-3xl text-black font-noto-serif"},[e("span",{class:"mr-2 text-4xl material-symbols-outlined text-black-light"}," sell "),p("優惠券")],-1),re=e("span",{class:"material-symbols-outlined"}," add ",-1),de={class:"container flex flex-col mb-11 min-h-[679px]"},ce={class:"overflow-x-auto"},pe={class:"inline-block min-w-full py-2"},ue={class:"overflow-hidden"},he={class:"min-w-full text-sm font-light text-left"},fe=e("thead",{class:"font-medium border-b border-gray-400 break-keep"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4"},"名稱"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"優惠碼"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"折扣百分比"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"到期日"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"啟用狀態"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"最後更新時間"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"編輯")])],-1),me={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 font-normal whitespace-nowrap"},be={class:"flex items-center"},xe={class:"px-6 py-4 font-normal whitespace-nowrap"},ge={class:"px-6 py-4 font-normal whitespace-nowrap"},we={class:"px-6 py-4 font-normal whitespace-nowrap"},ye={key:0,class:"font-normal text-success"},ke={key:1,class:"text-gray-400"},ve={class:"px-6 py-4 whitespace-nowrap"},Ce={key:0},Me={key:1},$e={class:"px-6 py-4 whitespace-nowrap"},De=["onClick"],Se=e("span",{class:"material-symbols-outlined",style:{"font-variation-settings":`'FILL' 1,\r
                            'wght' 400,\r
                            'GRAD' 0,\r
                            'opsz' 24`}}," edit ",-1),Le=[Se],Te=["onClick"],ze=e("span",{class:"material-symbols-outlined"},"delete",-1),Ve=[ze];function Pe(n,t,i,r,o,a){const s=b("LoadingAnimation"),m=b("CouponModal"),v=b("DelModal"),C=b("Pagination");return d(),c(y,null,[x(s,{active:o.isLoading,"lock-scroll":!0},null,8,["active"]),e("main",ae,[e("div",le,[ie,e("button",{type:"button",class:"my-auto flex items-center rounded bg-cerulean px-6 py-2.5 text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80",onClick:t[0]||(t[0]=f(l=>a.openModal("new"),["prevent"]))},[re,p("新增優惠券 ")])]),e("div",de,[e("div",ce,[e("div",pe,[e("div",ue,[e("table",he,[fe,e("tbody",null,[(d(!0),c(y,null,T(o.coupons,l=>(d(),c("tr",{key:l.id,class:"transition duration-300 ease-in-out border-b hover:bg-neutral-100"},[e("th",me,u(l.title),1),e("td",_e,[e("div",be,u(l.code),1)]),e("td",xe,u(n.$filters.currency(l.percent))+" %",1),e("td",ge,u(n.$filters.onlyDate(l.due_date)),1),e("td",we,[l.is_enabled?(d(),c("p",ye,"啟用")):(d(),c("p",ke,"未啟用"))]),e("td",ve,[l.lastEditDate?(d(),c("p",Ce,u(n.$filters.date(l.lastEditDate)),1)):(d(),c("p",Me,"無紀錄"))]),e("td",$e,[e("button",{class:"inline-block pr-4 hover:text-cerulean",onClick:f(M=>a.openModal("edit",l),["prevent"])},Le,8,De),e("button",{class:"inline-block px-4 hover:text-danger",onClick:f(M=>a.openModal("del",l),["prevent"])},Ve,8,Te)])]))),128))])])])])])]),x(m,{ref:"couponModal",coupon:o.tempCoupon,onUpdateCoupons:a.updateCoupons,state:o.couponModalState},null,8,["coupon","onUpdateCoupons","state"]),x(v,{ref:"delModal",onDel:a.delCoupon,item:o.tempCoupon},null,8,["onDel","item"]),x(C,{pages:o.pagination,onChangePage:a.getCoupons},null,8,["pages","onChangePage"])])],64)}const Ae=k(ne,[["render",Pe]]);export{Ae as default};
