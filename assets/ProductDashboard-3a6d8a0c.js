import{s as w}from"./statesStore-aff85be1.js";import{C as T,a as $}from"./ckeditor-b4cfffbd.js";import{m as I}from"./modalMixin-e43cb9db.js";import{_ as U,r as g,o as n,c as l,d as e,t as h,g as u,h as P,f,F as v,i as y,k as m,v as b,e as _,u as D,n as x,P as M}from"./index-ca38e9cf.js";import{D as V,P as z}from"./PaginationBackend-84f8eb59.js";import"./tw-elements.es.min-5f64f089.js";const S={data(){return{tempProduct:{},tempTag:"",loadingIcon:!1,editor:T,editorConfig:{toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","|","imageUpload","blockQuote","undo","redo"]}}},props:{product:{type:Object,default(){return{tempProduct:{}}}},state:{type:String},allTags:{type:Array}},watch:{product(){this.tempProduct=this.product}},methods:{uploadPhoto(r){if(r==="button"&&this.$refs.imageUrlInput.value!==""){if(this.loadingIcon=!0,this.tempProduct.imageUrl===""||!this.tempProduct.imageUrl){this.tempProduct.imageUrl=this.$refs.imageUrlInput.value,this.$refs.imageUrlInput.value="",this.loadingIcon=!1;return}this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imagesUrl.push(this.$refs.imageUrlInput.value),this.$refs.imageUrlInput.value="",this.loadingIcon=!1}if(r==="file"){this.loadingIcon=!0;const o=this.$refs.imageFileInput.files[0],a=new FormData;a.append("file-to-upload",o);const d="https://vue3-course-api.hexschool.io/api/yu-api/admin/upload";this.$http.post(d,a).then(t=>{if(t.data.success){if(this.tempProduct.imageUrl===""||!this.tempProduct.imageUrl){this.tempProduct.imageUrl=t.data.imageUrl,this.$refs.imageFileInput.value="",this.loadingIcon=!1,w().pushToastMessage(t.data.success,"上傳成功");return}this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imagesUrl.push(t.data.imageUrl),this.$refs.imageFileInput.value="",this.loadingIcon=!1,w().pushToastMessage(t.data.success,"上傳成功")}else w().pushToastMessage(t.data.success,"上傳失敗",t.data.message)})}},delPhoto(r){this.tempProduct.imageUrl===r?this.tempProduct.imageUrl="":this.tempProduct.imagesUrl.splice(r,1)},pushTag(){this.tempProduct.tag||(this.tempProduct.tag=[]),this.tempProduct.tag.push(this.tempTag),this.tempTag=""},selectTag(r){this.tempProduct.tag||(this.tempProduct.tag=[]);const o=this.tempProduct.tag.indexOf(r);o<0?this.tempProduct.tag.push(r):this.tempProduct.tag.splice(o,1)}},mixins:[I],components:{ckeditor:$.component}},j={"data-te-modal-init":"",class:"fixed left-0 top-0 z-[1055] hidden h-full w-full overflow-y-auto overflow-x-hidden outline-none",id:"addModal",tabindex:"-1","aria-labelledby":"productModal","aria-modal":"true",role:"dialog","data-te-backdrop":"static",ref:"modal"},F={"data-te-modal-dialog-ref":"",class:"pointer-events-none relative w-auto translate-y-[-50px] opacity-0 transition-all duration-300 ease-in-out min-[576px]:mx-auto mt-7 min-[576px]:max-w-[800px] min-[1024px]:max-w-[1140px] px-2 sm:px-5"},E={class:"relative flex flex-col w-full text-current bg-white border-none rounded-md shadow-lg outline-none pointer-events-auto bg-clip-padding max-h-[94vh] lg:max-h-[90vh]"},B={class:"flex items-center justify-between flex-shrink-0 p-4 border-b-2 border-opacity-100 rounded-t-md border-neutral-100"},A={class:"text-xl font-medium leading-normal text-neutral-800",id:"exampleModalXlLabel"},O=e("button",{type:"button",class:"box-content border-none rounded-none hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none","data-te-modal-dismiss":"","aria-label":"Close"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1),N={class:"relative p-4 overflow-y-auto"},R={class:"flex flex-col-reverse gap-5 lg:flex-row"},Z={class:"border-t-2 lg:w-5/12 lg:border-0"},q={class:"mt-4 mb-4 lg:mt-0"},K={for:"formFile",class:"flex gap-2 mb-1 text-neutral-700"},G={key:0,class:"flex items-center gap-2 text-gray-500"},Q=e("div",{class:"inline-block h-4 w-4 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",role:"status"},[e("span",{class:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]"},"Loading...")],-1),X=e("p",null,"上傳中",-1),H=[Q,X],J=["disabled"],W={class:"mb-4"},Y=e("label",{for:"imageUrl",class:"block mb-1"},"或 輸入網址",-1),ee={class:"relative flex flex-wrap items-stretch"},te=["disabled"],oe={class:"relative w-full p-1 aspect-square"},se=e("div",{class:"absolute top-[1%] bottom-[1%] left-[1%] right-[1%] flex items-center justify-center border-2 border-dotted"},[e("div",{class:"text-center text-gray-400"},[e("h6",{class:"text-2xl leading-10"},"主要圖片"),e("p",null,"假如目前沒有主要圖片，上傳時會優先補上")])],-1),re={key:0,class:"relative bg-white"},ne=["src","alt","title"],le=e("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M3.4 16L2 14.6L7.6 9L2 3.4L3.4 2L9 7.6L14.6 2L16 3.4L10.4 9L16 14.6L14.6 16L9 10.4L3.4 16Z",fill:"white","fill-opacity":"0.8"}),e("path",{d:"M3.04645 16.3536L3.4 16.7071L3.75355 16.3536L9 11.1071L14.2464 16.3536L14.6 16.7071L14.9536 16.3536L16.3536 14.9536L16.7071 14.6L16.3536 14.2464L11.1071 9L16.3536 3.75355L16.7071 3.4L16.3536 3.04645L14.9536 1.64645L14.6 1.29289L14.2464 1.64645L9 6.89289L3.75355 1.64645L3.4 1.29289L3.04645 1.64645L1.64645 3.04645L1.29289 3.4L1.64645 3.75355L6.89289 9L1.64645 14.2464L1.29289 14.6L1.64645 14.9536L3.04645 16.3536Z",stroke:"#303030","stroke-opacity":"0.8","stroke-miterlimit":"10"})],-1),ae=[le],ie={class:"flex flex-wrap"},ce=["src","alt"],de=["title","onClick"],ue=e("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M3.4 16L2 14.6L7.6 9L2 3.4L3.4 2L9 7.6L14.6 2L16 3.4L10.4 9L16 14.6L14.6 16L9 10.4L3.4 16Z",fill:"white","fill-opacity":"0.8"}),e("path",{d:"M3.04645 16.3536L3.4 16.7071L3.75355 16.3536L9 11.1071L14.2464 16.3536L14.6 16.7071L14.9536 16.3536L16.3536 14.9536L16.7071 14.6L16.3536 14.2464L11.1071 9L16.3536 3.75355L16.7071 3.4L16.3536 3.04645L14.9536 1.64645L14.6 1.29289L14.2464 1.64645L9 6.89289L3.75355 1.64645L3.4 1.29289L3.04645 1.64645L1.64645 3.04645L1.29289 3.4L1.64645 3.75355L6.89289 9L1.64645 14.2464L1.29289 14.6L1.64645 14.9536L3.04645 16.3536Z",stroke:"#303030","stroke-opacity":"0.8","stroke-miterlimit":"10"})],-1),pe=[ue],fe={class:"lg:w-7/12"},he={class:"mb-4"},me=e("label",{for:"name",class:"block mb-1"},[u("商品名稱"),e("span",{class:"text-danger"}," *")],-1),be={class:"flex gap-2 mb-4"},_e={class:"w-1/2"},ge=e("label",{for:"category",class:"block mb-1"},[u("分類"),e("span",{class:"text-danger"}," *")],-1),xe={class:"w-1/2"},we=e("label",{for:"unit",class:"block mb-1"},[u("單位"),e("span",{class:"text-danger"}," *")],-1),ve={class:"flex gap-2 mb-4"},ke={class:"w-1/2"},ye=e("label",{for:"origin",class:"block mb-1"},[u("原價"),e("span",{class:"text-danger"}," *")],-1),Pe={class:"w-1/2"},Le=e("label",{for:"price",class:"block mb-1 font-semibold"},[u("售價"),e("span",{class:"text-danger"}," *")],-1),Me={class:"mb-4"},Ue=e("label",{for:"description",class:"block mb-1"},"商品描述",-1),Ce={class:"mb-4"},Te=e("label",{for:"content",class:"block mb-1"},"商品內容",-1),$e={class:"mb-4"},Ie=e("label",{for:"tag",class:"block mb-1"},"＃ tag 標籤",-1),De={class:"mb-4"},Ve={class:"font-semibold text-cerulean"},ze={class:"flex flex-wrap items-center gap-2"},Se=["onClick"],je={class:"ml-[2px]"},Fe=["onClick"],Ee={class:"ml-[2px]"},Be={class:"flex flex-col gap-4 mb-4"},Ae=e("p",{class:"mb-1"},"是否上架",-1),Oe=["checked"],Ne=e("p",{class:"mb-1"},"是否為推薦商品",-1),Re=["checked"],Ze={class:"flex flex-wrap items-center justify-end flex-shrink-0 gap-2 p-4 border-t-2 border-opacity-100 rounded-b-md border-neutral-100"},qe=e("button",{type:"button",class:"inline-block px-[23px] py-[9px] text-sm font-medium leading-normal text-right text-black uppercase transition duration-150 ease-in-out bg-transparent border border-gray-300 rounded focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80 hover:bg-gray-100","data-te-modal-dismiss":""}," 取消 ",-1);function Ke(r,o,a,d,t,i){const k=g("ckeditor");return n(),l("div",j,[e("div",F,[e("div",E,[e("div",B,[e("h5",A,h(a.state==="new"?"新增":"編輯")+"商品 ",1),O]),e("div",N,[e("div",R,[e("div",Z,[e("div",q,[e("label",K,[u("上傳圖片 "),t.loadingIcon?(n(),l("div",G,H)):P("",!0)]),e("input",{class:"relative m-0 block w-full min-w-0 flex-auto rounded border border-solid border-neutral-300 bg-clip-padding px-3 py-[0.32rem] text-base font-normal text-neutral-700 transition duration-300 ease-in-out file:-mx-3 file:-my-[0.32rem] file:overflow-hidden file:rounded-none file:border-0 file:border-solid file:border-inherit file:bg-neutral-100 file:px-3 file:py-[0.32rem] file:text-neutral-700 file:transition file:duration-150 file:ease-in-out file:[border-inline-end-width:1px] file:[margin-inline-end:0.75rem] hover:file:bg-neutral-200 focus:border-primary focus:text-neutral-700 focus:shadow-te-primary focus:outline-none",type:"file",id:"formFile",ref:"imageFileInput",onChange:o[0]||(o[0]=f(s=>i.uploadPhoto("file"),["prevent"])),disabled:t.loadingIcon},null,40,J)]),e("div",W,[Y,e("div",ee,[e("input",{type:"text",class:"relative m-0 block w-[1px] min-w-0 flex-auto rounded-l border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none border-r-0",placeholder:"https://",id:"imageUrl","aria-label":"Recipient's username","aria-describedby":"basic-addon2",ref:"imageUrlInput",disabled:t.loadingIcon},null,8,te),e("button",{type:"button",class:"rounded-r border border-solid border-neutral-300 px-3 py-[0.25rem] text-center text-base font-normal leading-[1.6] text-neutral-700 hover:bg-cerulean hover:text-white hover:border-cerulean",id:"basic-addon2",onClick:o[1]||(o[1]=f(s=>i.uploadPhoto("button"),["prevent"]))},"新增")])]),e("div",oe,[se,t.tempProduct.imageUrl?(n(),l("div",re,[e("img",{class:"object-cover object-center w-full aspect-square",src:t.tempProduct.imageUrl,alt:`${t.tempProduct.title}-主要圖片`,title:`${t.tempProduct.title}-主要圖片`},null,8,ne),e("button",{class:"box-content absolute top-0 right-0 p-2 border-none rounded-none text-black-light material-symbols-outlined hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none",title:"刪除主要圖片",onClick:o[2]||(o[2]=f(s=>i.delPhoto(t.tempProduct.imageUrl),["prevent"]))},ae)])):P("",!0)]),e("ul",ie,[(n(!0),l(v,null,y(t.tempProduct.imagesUrl,(s,p)=>(n(),l("li",{class:"relative w-1/3 p-1",key:`${s.title}${p}`},[e("img",{class:"object-cover object-center w-full aspect-square",src:s,alt:`${t.tempProduct.title}-圖片${p+2}`},null,8,ce),e("button",{class:"box-content absolute top-0 right-0 p-2 border-none rounded-none text-black-light material-symbols-outlined hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none",title:`刪除圖片${p+2}`,onClick:f(L=>i.delPhoto(p),["prevent"])},pe,8,de)]))),128))])]),e("div",fe,[e("div",he,[me,m(e("input",{type:"text",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入商品名稱",id:"name","onUpdate:modelValue":o[3]||(o[3]=s=>t.tempProduct.title=s)},null,512),[[b,t.tempProduct.title]])]),e("div",be,[e("div",_e,[ge,m(e("input",{type:"text",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入分類",id:"category","onUpdate:modelValue":o[4]||(o[4]=s=>t.tempProduct.category=s)},null,512),[[b,t.tempProduct.category]])]),e("div",xe,[we,m(e("input",{type:"text",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入單位",id:"unit","onUpdate:modelValue":o[5]||(o[5]=s=>t.tempProduct.unit=s)},null,512),[[b,t.tempProduct.unit]])])]),e("div",ve,[e("div",ke,[ye,m(e("input",{type:"number",min:"0",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入原價",id:"origin","onUpdate:modelValue":o[6]||(o[6]=s=>t.tempProduct.origin_price=s)},null,512),[[b,t.tempProduct.origin_price]])]),e("div",Pe,[Le,m(e("input",{type:"number",min:"0",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"請輸入售價",id:"price","onUpdate:modelValue":o[7]||(o[7]=s=>t.tempProduct.price=s)},null,512),[[b,t.tempProduct.price]])])]),e("div",Me,[Ue,_(k,{editor:t.editor,modelValue:t.tempProduct.description,"onUpdate:modelValue":o[8]||(o[8]=s=>t.tempProduct.description=s),config:t.editorConfig,id:"description"},null,8,["editor","modelValue","config"])]),e("div",Ce,[Te,_(k,{editor:t.editor,modelValue:t.tempProduct.content,"onUpdate:modelValue":o[9]||(o[9]=s=>t.tempProduct.content=s),config:t.editorConfig,id:"content"},null,8,["editor","modelValue","config"])]),e("div",$e,[Ie,m(e("input",{type:"text",class:"m-0 block w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-base font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none",placeholder:"不用加前綴「＃」，直接輸入名稱即可",id:"tag","onUpdate:modelValue":o[10]||(o[10]=s=>t.tempTag=s),onKeydown:o[11]||(o[11]=D(s=>i.pushTag(),["enter"]))},null,544),[[b,t.tempTag]])]),e("div",De,[e("div",Ve,[e("div",ze,[(n(!0),l(v,null,y(a.allTags,s=>(n(),l("button",{href:"#",class:x(["px-2 py-2 text-sm leading-3 border rounded-full border-cerulean hover:bg-cerulean hover:text-white",{"text-white  bg-cerulean":t.tempProduct.tag&&t.tempProduct.tag.includes(s)}]),key:s,onClick:f(p=>i.selectTag(s),["prevent"])},[u("＃"),e("span",je,h(s),1)],10,Se))),128)),(n(!0),l(v,null,y(t.tempProduct.tag,s=>(n(),l("button",{href:"#",class:x(["px-2 py-2 text-sm leading-3 text-white rounded-full bg-cerulean",{" hidden ":a.allTags.some(p=>p===s)}]),key:s,onClick:f(p=>i.selectTag(s),["prevent"])},[u("＃"),e("span",Ee,h(s),1)],10,Fe))),128))])])]),e("div",Be,[e("div",null,[Ae,m(e("input",{class:"mr-2 mt-[0.3rem] h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-success checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-neutral-100 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-success checked:focus:bg-success checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",checked:t.tempProduct.is_enabled,"onUpdate:modelValue":o[12]||(o[12]=s=>t.tempProduct.is_enabled=s)},null,8,Oe),[[M,t.tempProduct.is_enabled]]),e("label",{class:x(["inline-block pl-[0.15rem] hover:cursor-pointer",t.tempProduct.is_enabled?" text-success":" text-gray-400"]),for:"flexSwitchCheckDefault"},h(t.tempProduct.is_enabled?"上架中":"未上架"),3)]),e("div",null,[Ne,m(e("input",{class:"mr-2 mt-[0.3rem] h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-success checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-neutral-100 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-success checked:focus:bg-success checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"switchCheckRecommend",checked:t.tempProduct.is_recommend,"onUpdate:modelValue":o[13]||(o[13]=s=>t.tempProduct.is_recommend=s)},null,8,Re),[[M,t.tempProduct.is_recommend]]),e("label",{class:x(["inline-block pl-[0.15rem] hover:cursor-pointer",t.tempProduct.is_recommend?" text-success":" text-gray-400"]),for:"switchCheckRecommend"},h(t.tempProduct.is_recommend?"推薦":"未開啟"),3)])])])])]),e("div",Ze,[qe,e("button",{type:"button",class:"inline-block rounded bg-cerulean px-6 py-2.5 text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80 text-right",onClick:o[14]||(o[14]=f(s=>r.$emit("update-products",this.tempProduct),["prevent"]))}," 確認 ")])])])],512)}const Ge=U(S,[["render",Ke]]),Qe={data(){return{products:[],tempProduct:{},productModalState:"edit",pagination:{},allTags:[],isLoading:!1}},methods:{getProducts(r=1){this.isLoading=!0;const o=`https://vue3-course-api.hexschool.io/api/yu-api/admin/products?page=${r}`;this.$http.get(o).then(a=>{a.data.success&&(this.products=a.data.products,this.pagination=a.data.pagination,this.getTags(),this.isLoading=!1)})},getTags(){this.allTags=[],this.products.forEach(r=>{Object.prototype.hasOwnProperty.call(r,"tag")&&this.allTags.push(...r.tag)}),this.allTags=this.allTags.filter((r,o,a)=>a.indexOf(r)===o)},updateProduct(r){const o=Math.floor(new Date().getTime()/1e3);this.tempProduct.lastEditDate=o;let a="post",d="https://vue3-course-api.hexschool.io/api/yu-api/admin/product";this.productModalState==="edit"&&(this.tempProduct=r,a="put",d=`https://vue3-course-api.hexschool.io/api/yu-api/admin/product/${r.id}`),this.$http[a](d,{data:this.tempProduct}).then(t=>{const i=w();t.data.success?(this.$refs.productModal.hideModal(),this.getProducts(this.pagination.current_page),this.tempProduct={},i.pushToastMessage(t.data.success,`${this.productModalState==="new"?"新增":"編輯"}成功`)):i.pushToastMessage(t.data.success,`${this.productModalState==="new"?"新增":"編輯"}失敗`,t.data.message)})},openModal(r,o){if(this.productModalState=r,this.tempProduct={...o},r==="del"){this.$refs.delModal.showModal();return}r==="new"&&(this.tempProduct={}),this.$refs.productModal.showModal()},delProduct(r){const o=w(),a=`https://vue3-course-api.hexschool.io/api/yu-api/admin/product/${r.id}`;this.$http.delete(a).then(d=>{d.data.success?(this.$refs.delModal.hideModal(),this.getProducts(),o.pushToastMessage(d.data.success,"刪除成功")):o.pushToastMessage(d.data.success,"刪除失敗",d.data.message)})}},created(){this.getProducts()},components:{ProductModal:Ge,DelModal:V,Pagination:z}},Xe={class:"ml-0 lg:ml-[310px]"},He={class:"container flex justify-between py-4 lg:mt-10 lg:text-right"},Je=e("h2",{class:"flex items-center text-3xl text-black font-noto-serif"},[e("span",{class:"mr-2 text-4xl material-symbols-outlined text-black-light"}," Lists "),u("商品列表")],-1),We=e("span",{class:"material-symbols-outlined"}," add ",-1),Ye={class:"container flex flex-col mb-11 min-h-[679px]"},et={class:"overflow-x-auto"},tt={class:"inline-block min-w-full py-2"},ot={class:"overflow-hidden"},st={class:"min-w-full text-sm font-light text-left"},rt=e("thead",{class:"font-medium border-b border-gray-400 break-keep"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"類別"),e("th",{scope:"col",class:"px-6 py-4"},"商品名稱"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"原價"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"售價"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"上架"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"最後更新時間"),e("th",{scope:"col",class:"px-6 py-4 w-[10%]"},"編輯")])],-1),nt={class:"px-6 py-4 whitespace-nowrap"},lt={class:"px-6 py-4 font-normal whitespace-nowrap"},at={class:"flex items-center"},it=["src"],ct={key:1,class:"mr-2 material-symbols-outlined text-[28px]"},dt={key:2,class:"px-2 leading-3 ml-2 text-[8px] text-white rounded-full font-montserrat bg-success"},ut={class:"px-6 py-4 font-normal text-gray-400 whitespace-nowrap"},pt={class:"px-6 py-4 font-normal whitespace-nowrap"},ft={class:"px-6 py-4 font-normal whitespace-nowrap"},ht={key:0,class:"font-normal text-success"},mt={key:1,class:"text-gray-400"},bt={class:"px-6 py-4 whitespace-nowrap"},_t={key:0},gt={key:1},xt={class:"px-6 py-4 whitespace-nowrap"},wt=["onClick"],vt=e("span",{class:"material-symbols-outlined",style:{"font-variation-settings":`'FILL' 1,\r
                            'wght' 400,\r
                            'GRAD' 0,\r
                            'opsz' 24`}}," edit ",-1),kt=[vt],yt=["onClick"],Pt=e("span",{class:"material-symbols-outlined"},"delete",-1),Lt=[Pt];function Mt(r,o,a,d,t,i){const k=g("LoadingAnimation"),s=g("ProductModal"),p=g("DelModal"),L=g("Pagination");return n(),l(v,null,[_(k,{active:t.isLoading,"lock-scroll":!0},null,8,["active"]),e("main",Xe,[e("div",He,[Je,e("button",{type:"button",class:"my-auto flex items-center rounded bg-cerulean px-6 py-2.5 text-sm font-medium uppercase leading-normal text-white transition duration-150 ease-in-out focus:outline-none focus:ring-0 active:bg-cerulean-700 hover:opacity-80",onClick:o[0]||(o[0]=f(c=>i.openModal("new"),["prevent"]))},[We,u("新增商品 ")])]),e("div",Ye,[e("div",et,[e("div",tt,[e("div",ot,[e("table",st,[rt,e("tbody",null,[(n(!0),l(v,null,y(t.products,c=>(n(),l("tr",{key:c.id,class:x(["transition duration-300 ease-in-out border-b hover:bg-neutral-100",{"bg-[#f2f2f2] ":!c.is_enabled}])},[e("th",nt,h(c.category),1),e("td",lt,[e("div",at,[c.imageUrl?(n(),l("img",{key:0,src:c.imageUrl,alt:"",class:"object-cover mr-2 w-[28px] h-[28px]"},null,8,it)):(n(),l("span",ct," image ")),u(" "+h(c.title)+" ",1),c.origin_price!==c.price?(n(),l("span",dt,"SALE")):P("",!0)])]),e("td",ut,"$ "+h(r.$filters.currency(c.origin_price)),1),e("td",pt,"$ "+h(r.$filters.currency(c.price)),1),e("td",ft,[c.is_enabled?(n(),l("p",ht,"上架")):(n(),l("p",mt,"未上架"))]),e("td",bt,[c.lastEditDate?(n(),l("p",_t,h(r.$filters.date(c.lastEditDate)),1)):(n(),l("p",gt,"無紀錄"))]),e("td",xt,[e("button",{class:"inline-block pr-4 hover:text-cerulean",onClick:f(C=>i.openModal("edit",c),["prevent"])},kt,8,wt),e("button",{class:"inline-block px-4 hover:text-danger",onClick:f(C=>i.openModal("del",c),["prevent"])},Lt,8,yt)])],2))),128))])])])])])]),_(s,{product:t.tempProduct,state:t.productModalState,allTags:t.allTags,onUpdateProducts:i.updateProduct,ref:"productModal"},null,8,["product","state","allTags","onUpdateProducts"]),_(p,{ref:"delModal",onDel:i.delProduct,item:t.tempProduct},null,8,["onDel","item"]),_(L,{pages:t.pagination,onChangePage:i.getProducts},null,8,["pages","onChangePage"])])],64)}const Vt=U(Qe,[["render",Mt]]);export{Vt as default};
